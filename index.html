document.addEventListener('DOMContentLoaded', async (event) => {
    // ...

    async function generateTable() {
        // ...

        // 各氏名ごとに行を生成
        for (const name of names) {
            let row = table.insertRow();
            let nameCell = row.insertCell(0);
            nameCell.innerText = name;

            for (let i = 1; i <= monthDays; i++) {
                let dateCell = row.insertCell(i);
                dateCell.innerText = ''; // 空のセルを挿入

                // 不要な日をグレーアウト
                if (i > monthDaysInMonth) {
                    dateCell.classList.add('inactive-day');
                }

                // Firestoreからデータを取得してセルに挿入
                const docRef = doc(db, 'attendance', name);
                const docSnap = await getDoc(docRef);
                const date = `${months[currentMonth]} ${i}日`;
                if (docSnap.exists() && docSnap.data()[date]) {
                    dateCell.innerText = docSnap.data()[date];
                }
            }
        }
    }

    // ...
});
